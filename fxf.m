function val = fxf(p,theta_0,x_0,x_f)
    p1 = p(1);
    p2 = p(2);
    p3 = p(3);
    p4 = p(4);
    p5 = p(5);
    
    val = (x_0 - x_f + (p5*(cos(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3) + 2*cos(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24) + 2*cos(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64) + 2*cos(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192) + 4*cos(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512) + 4*cos(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + cos(theta_0)))/24)^2;
    val1 = (p5*(cos(theta_0) + 4*cos(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0) + 4*cos(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + cos(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0))/24 + x_0 - x_f)^2;
%     val = val1;
%     (x_0 - x_f + (p5*(cos(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3) + 2*cos(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24) + 2*cos(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64) + 2*cos(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192) + 4*cos(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512) + 4*cos(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + cos(theta_0)))/24)^2
%     (x_0 - x_f + (p5*(cos(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3) + 2*cos(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24) + 2*cos(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64) + 2*cos(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192) + 4*cos(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512) + 4*cos(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + cos(theta_0)))/24)^2
    a = 5;
    
