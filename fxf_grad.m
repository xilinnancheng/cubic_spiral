function grad = fxf_grad(p, theta_0, x_0, x_f)
    p1 = p(1);
    p2 = p(2);
    p3 = p(3);
    p4 = p(4);
    p5 = p(5);
    grad = zeros(3,1);
    grad(1) = -(p5*(x_0 - x_f + (p5*(cos(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3) + 2*cos(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24) + 2*cos(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64) + 2*cos(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192) + 4*cos(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512) + 4*cos(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + cos(theta_0)))/24)*((3*p5*sin(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3))/8 + (51*p5*sin(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24))/64 + (891*p5*sin(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64))/1024 + (363*p5*sin(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192))/1024 + (9963*p5*sin(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512))/8192 + (1851*p5*sin(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536))/8192 + (14475*p5*sin(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536))/8192 + (13083*p5*sin(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536))/8192))/12;
    grad(2) = -(p5*(x_0 - x_f + (p5*(cos(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3) + 2*cos(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24) + 2*cos(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64) + 2*cos(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192) + 4*cos(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512) + 4*cos(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + cos(theta_0)))/24)*((3*p5*sin(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3))/8 - (3*p5*sin(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24))/64 + (405*p5*sin(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64))/1024 - (123*p5*sin(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192))/1024 - (2187*p5*sin(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512))/8192 - (795*p5*sin(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536))/8192 + (2325*p5*sin(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536))/8192 + (10437*p5*sin(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536))/8192))/12;
    grad(3) = 2*(x_0 - x_f + (p5*(cos(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3) + 2*cos(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24) + 2*cos(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64) + 2*cos(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192) + 4*cos(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512) + 4*cos(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + 4*cos(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536) + cos(theta_0)))/24)*(cos(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3)/24 + cos(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24)/12 + cos(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64)/12 + cos(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192)/12 + cos(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512)/6 + cos(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536)/6 + cos(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536)/6 + cos(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536)/6 + cos(theta_0)/24 - (p5*(sin(theta_0 + p1*p5 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/2 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/4 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/3)*(p1/8 + (3*p2)/8 + (3*p3)/8 + p4/8) + 2*sin(theta_0 + (p1*p5)/2 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/8 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/64 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/24)*((15*p1)/128 + (51*p2)/128 - (3*p3)/128 + p4/128) + 2*sin(theta_0 + (p1*p5)/4 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/192)*((247*p1)/2048 + (363*p2)/2048 - (123*p3)/2048 + (25*p4)/2048) + 2*sin(theta_0 + (3*p1*p5)/4 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/32 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/1024 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/64)*((231*p1)/2048 + (891*p2)/2048 + (405*p3)/2048 + (9*p4)/2048) + 4*sin(theta_0 + (p1*p5)/8 - (p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536)*((2871*p1)/32768 + (1851*p2)/32768 - (795*p3)/32768 + (169*p4)/32768) + 4*sin(theta_0 + (3*p1*p5)/8 - (9*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (81*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (9*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/512)*((4071*p1)/32768 + (9963*p2)/32768 - (2187*p3)/32768 + (441*p4)/32768) + 4*sin(theta_0 + (5*p1*p5)/8 - (25*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (625*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (125*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536)*((3655*p1)/32768 + (14475*p2)/32768 + (2325*p3)/32768 + (25*p4)/32768) + 4*sin(theta_0 + (7*p1*p5)/8 - (49*p5*((11*p1)/2 - 9*p2 + (9*p3)/2 - p4))/128 - (2401*p5*((9*p1)/2 - (27*p2)/2 + (27*p3)/2 - (9*p4)/2))/16384 + (343*p5*(9*p1 - (45*p2)/2 + 18*p3 - (9*p4)/2))/1536)*((3927*p1)/32768 + (13083*p2)/32768 + (10437*p3)/32768 + (1225*p4)/32768)))/24);
    
        grad_tmp_x = [p5*(p5*(cos(theta_0) + 4*cos(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0) + 4*cos(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + cos(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0))/24 + x_0 - x_f)*(-1851*p5*sin(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 - 363*p5*sin(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0)/1024 - 9963*p5*sin(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 - 51*p5*sin(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0)/64 - 14475*p5*sin(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 - 891*p5*sin(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0)/1024 - 13083*p5*sin(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 - 3*p5*sin(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0)/8)/12, p5*(p5*(cos(theta_0) + 4*cos(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0) + 4*cos(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + cos(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0))/24 + x_0 - x_f)*(795*p5*sin(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 + 123*p5*sin(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0)/1024 + 2187*p5*sin(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 + 3*p5*sin(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0)/64 - 2325*p5*sin(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 - 405*p5*sin(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0)/1024 - 10437*p5*sin(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/8192 - 3*p5*sin(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0)/8)/12, (p5*(cos(theta_0) + 4*cos(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0) + 4*cos(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + 2*cos(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) + 4*cos(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) + cos(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0))/24 + x_0 - x_f)*(p5*(-4*(2871*p1/32768 + 1851*p2/32768 - 795*p3/32768 + 169*p4/32768)*sin(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) - 4*(3655*p1/32768 + 14475*p2/32768 + 2325*p3/32768 + 25*p4/32768)*sin(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) - 2*(231*p1/2048 + 891*p2/2048 + 405*p3/2048 + 9*p4/2048)*sin(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) - 2*(15*p1/128 + 51*p2/128 - 3*p3/128 + p4/128)*sin(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0) - 4*(3927*p1/32768 + 13083*p2/32768 + 10437*p3/32768 + 1225*p4/32768)*sin(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) - 2*(247*p1/2048 + 363*p2/2048 - 123*p3/2048 + 25*p4/2048)*sin(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0) - 4*(4071*p1/32768 + 9963*p2/32768 - 2187*p3/32768 + 441*p4/32768)*sin(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0) - (p1/8 + 3*p2/8 + 3*p3/8 + p4/8)*sin(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0))/12 + cos(theta_0)/12 + cos(p1*p5/8 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/3 + cos(p1*p5/4 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0)/6 + cos(3*p1*p5/8 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/3 + cos(p1*p5/2 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/16 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/128 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/16 + theta_0)/6 + cos(5*p1*p5/8 + 25*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 625*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 125*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/3 + cos(3*p1*p5/4 + 9*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/64 + 81*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/2048 + 27*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/128 + theta_0)/6 + cos(7*p1*p5/8 + 49*p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/256 + 2401*p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/32768 + 343*p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/1024 + theta_0)/3 + cos(p1*p5 + p5*(-11*p1 + 18*p2 - 9*p3 + 2*p4)/4 + p5*(-9*p1 + 27*p2 - 27*p3 + 9*p4)/8 + p5*(6*p1 - 15*p2 + 12*p3 - 3*p4)/2 + theta_0)/12)]
             
    a = 5;